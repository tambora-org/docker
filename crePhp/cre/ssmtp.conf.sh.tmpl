#!/bin/bash 

# Current Container Name : {{ $CurrentContainer.Name }}

{{ $domain = "localhost" }}
{{ range $creDomain, $containers := groupByMulti $ "Env.CRE_DOMAIN" "," }}
  {{ $domain = $creDomain }}
{{ end }} 

echo "FromLineOverride=YES" > /etc/ssmtp/ssmtp.conf
echo "mailhub=mail.{{ $domain }}:587" >> /etc/ssmtp/ssmtp.conf
echo "hostname={{ $domain }}" >> /etc/ssmtp/ssmtp.conf
echo "UseTLS=YES" >> /etc/ssmtp/ssmtp.conf
echo "UseSTARTTLS=YES" >> /etc/ssmtp/ssmtp.conf

# https://blog.doenselmann.com/emails-automatisch-mit-ssmtp-versenden/
# /etc/ssmtp/revaliases
# root:alerts@yourdomain.com:smtp.yourdomain.com:587
# username:alerts@yourdomain.com:smtp.yourdomain.com:587


